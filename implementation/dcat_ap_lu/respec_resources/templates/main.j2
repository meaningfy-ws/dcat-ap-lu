{% extends "base.j2" %}

{# Custom macro with DCAT column - different name to avoid conflicts #}
{% macro renderEntityOverwrite(entity) %}
    <section>
        <h3 id="{{ entity.label[language]| replace(' ','') |urlencode | title }}">
            <a href="{{ entity.uri }}"
               data-toggle="tooltip"
               data-content="{{ entity.uri }}"
               data-placement="right">{{ entity.label[language] }}</a>

        </h3>
        <span style="float:right;margin-right:10px;">{{ renderFeedbackButton(entity) }}</span>

        <dl>
            <dt>
                Definition
            </dt>
            <dd>
                {{ entity.description[language] | safe }}
            </dd>
            {% if entity.tags[config.usageNoteTagName] %}
                <dt>
                    Usage Note
                </dt>
                <dd>
                    {{ entity.tags[config.usageNoteTagName] | safe }}
                </dd>
            {% endif %}
            {% if ((entity.parents | length) > 0 ) %}
                <dt>
                    Subclass of
                </dt>
                <dd>
                    {%- for parent in entity['parents'] %}
                        <a href="{{ parent.scoped_uri | replace(' ','') }}">{{ parent.label[language] }}</a>
                        {% if not loop.last %},{% endif %}
                    {%- endfor %}
                </dd>
            {% endif %}
            {% if config.showReferencesInRespec and entity.tags[config.referenceTagName] %}
                <dt>
                    {{ config.classReferenceRespecLabel if config.classReferenceRespecLabel else 'References' }}
                </dt>
                <dd>
                    {{ entity.tags[config.referenceTagName] | safe }}
                </dd>
            {% endif %}
            <dt>
                Properties
            </dt>
            {% if ((entity.properties | length) > 0 ) %}
                <dd>
                    For this entity the following properties are defined:
                    {%- for prop in entity['properties'] | sort(attribute='label[language]') %}
                        {# lower the first letter in case it's uppercase #}
                        {% set propertyLabel = prop.label[language][:1]|lower ~ prop.label[language][1:] %}
                        <a href="#{{ (entity.label[language] ~ '.' ~ prop.label[language]) | replace(' ','') | urlencode | title }}">{{ propertyLabel }}</a>
                        {%- if not loop.last %},{% endif %}
                    {%- endfor %}.
                </dd>
            {% else %}
                <dd>
                    This specification does not impose any additional requirements to properties for this entity.
                </dd>
            {% endif %}
        </dl>
        {% if ((entity.properties | length) > 0 ) %}
            <div class="u-table-overflow">
                <table class="data-table simple" id="table-mandatory-classes">
                    <thead>
                    <tr class="data-table__header">
                        <th class="data-table__header-title--sortable data-table__header-title--sortable-active"
                            style="width:12%">
                            Property
                        </th>
                        <th class="data-table__header-title--sortable" style="width:12%">
                            Range
                        </th>
                        <th class="data-table__header-title--sortable" style="width:6%">
                            Card
                        </th>
                        <th class="data-table__header-title--sortable" style="width:25%">
                            Definition
                        </th>
                        <th class="data-table__header-title--sortable" style="width:25%">
                            Usage
                        </th>
                        <th class="data-table__header-title--sortable" style="width:20%">
                            DCAT
                        </th>
                        {% if config.showReferencesInRespec %}
                            <th class="data-table__header-title--sortable" style="width:20%">
                                {{ config.propertyReferenceRespecLabel if config.propertyReferenceRespecLabel else 'Reuse' }}
                            </th>
                        {% endif %}
                        {% if metadata.openGithubIssue %}
                            <th class="data-table__header-title--sortable data-table__header-title--sortable-active"
                                style="width:5%">
                                {{ metadata.openGithubIssue.columnLabel if metadata.openGithubIssue.columnLabel else 'Open an issue' }}
                            </th>
                        {% endif %}
                    </tr>
                    </thead>
                    <tbody class="supertype">
                    {% for prop in entity['properties'] | sort(attribute=sortattr) %}
                        <tr id="{{ (entity.label[language] ~ '.' ~ prop.label[language]) | replace(' ','') |urlencode | title }}"
                            typeof="rdf:Property"
                            resource="{{ prop.uri }}"
                            class="class mandatory">
                            <td>
                                {# lower the first letter in case it's uppercase #}
                                {% set propertyLabel = prop.label[language][:1]|lower ~ prop.label[language][1:] %}
                                <a href="{{ prop.uri }}"
                                   data-toggle="tooltip"
                                   data-content="{{ prop.uri }}"
                                   data-placement="right">
                                    {{ propertyLabel }}</a>
                            </td>
                            <td>
                                {% for range in prop.range %}
                                    {% if range['range_uri'] == range['range_puri'] %}
                                        <a href="#{{ range['range_label'][language] | replace(' ','') |urlencode | title }}"
                                           data-toggle="tooltip"
                                           data-content="{{ range['range_puri'] }}"
                                           data-placement="right">{{ range['range_label'][language] }}</a>
                                    {% else %}
                                        <a href="#{{ range['range_label'][language] | replace(' ','') |urlencode | title }}"
                                           data-placement="right">{{ range['range_label'][language] }}</a>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                {{ prop.cardinality }}
                            </td>
                            <td>
                                {{ prop.description[language] | safe }}
                            </td>
                            <td>
                                {{ prop.tags[config.usageNoteTagName] | safe }}
                            </td>
                            <td>
                                {% if prop.tags["dct:references"] %}
                                    {{ prop.tags["dct:references"] | safe }}
                                {% else %}
                                    &nbsp;
                                {% endif %}
                            </td>
                            {% if config.showReferencesInRespec %}
                                <td>
                                    {% if prop.tags[config.referenceTagName] %}
                                        {{ prop.tags[config.referenceTagName] | safe }}
                                    {% else %}
                                        &nbsp;
                                    {% endif %}
                                </td>
                            {% endif %}
                            {% if metadata.openGithubIssue %}
                                <td>
                                    {{ renderFeedbackButton(entity, prop) }}
                                </td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        {% endif %}
    </section>
{% endmacro %}


{% block pageContent %}
    {% block abstract %}
        <section id="abstract">
            <p> This artefact provides the definitions for the DCAT-AP-LU. This artefact excludes the restrictions.
                DCAT-AP-LU is a Luxembourg-specific extension of the DCAT-AP profile used for sharing information about
                Catalogues containing Datasets and Data Services descriptions in Europe. It was created as part of the
                national implementation of the Data Governance Act (DGA) to support the creation of a single national
                dataset catalogue for all public sector data. The DCAT-AP-LU reuses large parts of the DCAT-AP-v3.0
                standard, with a set of minor adaptations to support specific requirements for Luxembourg.</p>
        </section>
    {% endblock %}

    {% block introduction %}
        <section id="specintro">
            <h2>Introduction</h2>
            <h3>Context</h3>

            DCAT-AP-LU is a Luxembourg-specific extension of the [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>] profile
            used for sharing information about Catalogues containing Datasets descriptions in Europe. It was created as
            part of the national implementation of the Data Governance Act (DGA) to support the creation of a single
            national dataset catalogue for all public sector data. The DCAT-AP-LU reuses large parts of the [<a
                href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>] standard, with a set of minor adaptations to support specific
            requirements for Luxembourg.

            <h3>Scope of the Application Profile</h3>

            This document provides guidelines for how to use DCAT-AP-LU to describe datasets in the context of the DGA
            national implementation but that are also interoperable with other national and international dataset
            catalogues following the [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>] specification.

            <h3>Revision history</h3>
            The first DCAT-AP-LU specification was released in March 2025. It focuses exclusively on the Dataset and
            Distribution concepts, as well as the most relevant supportive entities where these are reused "as is" from
            [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>] or where their specification differs for DCAT-AP-LU. A more
            complete version, including additional entities such as Catalogue, Data Service, DatasetSeries and further
            main and supportive entities will be released in Q2-2025.
        </section>
    {% endblock %}

    {% block status %}
        <section id="specstatus">
            <h2>Status</h2>
            <p>

                This application profile is published by a collaboration of the Luxembourg National Data Service (LNDS)
                and the Ministère de la Digitalisation, Luxembourg. It is developed with input and feedback from
                relevant national stakeholders. </p>

            <p>
                It has no official standing of any kind and does not represent the support or consensus of any standards
                organisation.
        </section>
    {% endblock %}

    {% block license %}
        <section id="speclicence">
            <h2>License</h2>
            <p>
                Copyright © 2025 Ministère de la Digitalisation, Luxembourg. All material in this repository is
                published under the license CC-BY 4.0,
                unless explicitly otherwise mentioned.
            </p>
        </section>
    {% endblock %}

    {% block conformance %}
        <section id="conformance">
            <p>

                As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in
                this specification are non-normative. Everything else in this specification is normative.

                The key words MAY, MUST, and SHOULD in this document are to be interpreted as described in <a
                    href="https://www.rfc-editor.org/info/bcp14">BCP 14</a> [<a href="#bib-rfc2119">RFC2119</a>] [<a
                    href="#bib-rfc8174">RFC8174</a>] when, and only when, they appear in all capitals, as shown here.
            </p>


            <h3>Conformance Statement</h3>
            <p>
                In order for applications to conform to DCAT-AP-LU, it MUST conform to [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>].
                In addition, the application must conform to the mentioned constraints and usage guidelines following
                similar conformance statements as specified in [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>].
            </p>
        </section>
    {% endblock %}

    {% block terminology %}
        <section id="specterminology">
            <h2>Terminology</h2>
            <p>
                An <strong>Application Profile</strong> is a specification that reuses terms from one or more base
                standards, adding more specificity by identifying mandatory, recommended and optional elements to be
                used for a particular application, as well as recommendations for controlled vocabularies to be used.
            </p>
            <p>
                A <strong>Dataset</strong> is a collection of data, published or curated by a single source, and
                available for access or download in one or more formats.
                A <strong>Data Portal</strong> is a Web-based system that contains a data catalogue with descriptions of
                datasets and provides services enabling discovery and reuse of the datasets.



                {% block usedPrefixesGen %}
                    {{ super() }}
                {% endblock %}
        </section>
    {% endblock %}

    {% block overview %}
        <section id="specoverview">
            <h2>Overview</h2>
            <p>
                DCAT-AP-LU is a DCAT application profile for sharing information about Catalogues containing Datasets
                descriptions in Luxembourg, compatible with the [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>] profile
                used in Europe. The core classes of the Application Profile are thus the classes Dataset and
                Distribution, with Catalogue and Data Service to be added in the second iteration.
            </p>
            <div id="overview">
                {% block overviewClassesGen %}
                    {% if ( ( classes | length > 0)   ) %}
                        <p>
                            This document describes the usage of the following main entities for a correct usage of the
                            vocabulary:
                            <br/>
                            | {%- for class in classes |sort(attribute=sortattr) %}
                            {%- if class.rawTags['class-usage-scope'] == "main" %}
                                <a href="#{{ class.label[language] | replace(' ','') |urlencode | title }}">{{ class.label[language] }}</a>
                                | {%- endif %}{%- endfor %}
                        </p>
                        <p>
                            The main entities are supported by:
                            <br/>
                            | {%- for class in classes |sort(attribute=sortattr) %}
                            {%- if class.rawTags['class-usage-scope'] != "main" %}
                                <a href="#{{ class.label[language] | replace(' ','') |urlencode | title }}">{{ class.label[language] }}</a>
                                | {%- endif %}{%- endfor %}
                        </p>
                    {% endif %}
                {% endblock %}
                {% block overviewDatatypesGen %}
                    {% if ( ( datatypes | length ) > 0 ) %}
                        <p>
                            And supported by these datatypes:
                            <br/>
                            | {%- for datatype in datatypes |sort(attribute=sortattr) %}
                            <a href="#{{ datatype.label[language] | replace(' ','') |urlencode | title }}">{{ datatype.label[language] }}</a>
                            | {%- endfor %}
                        </p>
                    {% endif %}
                {% endblock %}
            </div>
            <div>
                <a href="{{ assetsRoot }}/overview.png"
                   target="_blank">
                    <img src="{{ assetsRoot }}/overview.png"
                         onerror="this.style.display='none'"/>
                </a>
            </div>
        </section>
    {% endblock %}

    {% block mainEntities %}
        <section>
            <h2>Main Entities</h2>
            <p>
                The main entities are those that form the core of the Application Profile.
                The properties and their associated constraints that apply in the context of this profile are listed in
                a
                tabular form.
                Each row corresponds to one property.
                In addition to the constraints also cross-references are provided to [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>].
                <br><br>The <strong>Usage</strong> field is used to
                indicate usage constraint: </p>
            <ul>
                <li>A: reused as-is defined and expressed in [<a href="#bib-dcat-ap-v3.0">DCAT-AP-v3.0</a>]</li>
                <li>E: reused with additional usage notes or additional restrictions compared to [[DCAT-AP-v3.0]]</li>
                <li>P: DCAT-AP-LU profile specific extension where DCAT had no requirements earlier on specified</li>
            </ul>


            {% block mainEntitiesGen %}
                {% for entity in classes | sort(attribute=sortattr) %}
                    {% if entity.rawTags['class-usage-scope'] == "main" %}
                        {{ renderEntityOverwrite(entity) }}
                    {% endif %}
                {% endfor %}
            {% endblock %}
        </section>
    {% endblock %}

    {% block supportiveEntities %}
        <section>
            <h2>Supportive Entities</h2>
            The supportive entities are supporting the main entities in the vocabulary. They are included in the
            vocabulary because they form the range of properties.

            {% block supportiveEntitiesGen %}
                {% for entity in classes | sort(attribute=sortattr) %}
                    {% if entity.rawTags['class-usage-scope'] != "main" %}
                        {{ renderEntityOverwrite(entity) }}
                    {% endif %}
                {% endfor %}
            {% endblock %}
        </section>
    {% endblock %}

    {% block datatypes %}
        {{ super() }}
    {% endblock %}

    {% block usages %}
        <section class="informative">
            <h2>Usage Guidelines - change </h2>

            <h3>Basic Usage</h3>
            <p>To use this vocabulary, follow these guidelines:</p>

            {# You can include examples anywhere #}
            <div class="h3 examples" id="example1">Example 1</div>

        </section>
    {% endblock %}

    {% block governance %}
        <section class="informative">
            <h2>Governance</h2>
        </section>
    {% endblock %}

    {% block customSection %}
        <section class="informative">
            <h2>Custom section - TEMPLATE_CUSTOM_2024</h2>
            <p>A custom section introduced in main template</p>
        </section>

        <!-- Include custom template content -->
        {% include "custom.j2" ignore missing %}
    {% endblock %}

    {% block quickReference %}
        {{ super() }}
    {% endblock %}

    {% block resources %}
        {{ super() }}
    {% endblock %}


{% endblock %}
